{"remainingRequest":"C:\\MEIW_PAW\\MiniProj2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\MEIW_PAW\\MiniProj2\\src\\views\\users\\ListUsers.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\MEIW_PAW\\MiniProj2\\src\\views\\users\\ListUsers.vue","mtime":1576832059000},{"path":"C:\\MEIW_PAW\\MiniProj2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\MEIW_PAW\\MiniProj2\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\MEIW_PAW\\MiniProj2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\MEIW_PAW\\MiniProj2\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEZFVENIX1VTRVJTLCBSRU1PVkVfVVNFUiB9IGZyb20gIkAvc3RvcmUvdXNlcnMvdXNlci5jb25zdGFudHMiOwppbXBvcnQgSGVhZGVyUGFnZSBmcm9tICJAL2NvbXBvbmVudHMvSGVhZGVyUGFnZS52dWUiCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTWFuYWdlVXNlcnMiLAogIGNvbXBvbmVudHM6IHsKICAgIEhlYWRlclBhZ2UKICB9LAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcnM6IFtdLAogICAgICBzb3J0VHlwZTogMQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7ICAgIAogICAgLi4ubWFwR2V0dGVycyhbImdldFVzZXJMZXZlbEJ5UG9pbnRzIl0pLAogICAgLi4ubWFwR2V0dGVycygidXNlciIsIFsiZ2V0VXNlcnMiLCJnZXRNZXNzYWdlIl0pCiAgfSwKICBtZXRob2RzOiB7CiAgICBmZXRjaFVzZXJzKCkgewogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaChgdXNlci8ke0ZFVENIX1VTRVJTfWApLnRoZW4oIAogICAgICAgICgpID0+IHsKICAgICAgICAgIHRoaXMudXNlcnMgPSB0aGlzLmdldFVzZXJzOwogICAgICAgIH0sIGVyciA9PiB7CiAgICAgICAgICB0aGlzLiRhbGVydChgJHtlcnIubWVzc2FnZX1gLCAnRXJybycsICdlcnJvcicpOwogICAgICAgIH0pOwogICAgfSwKICAgIHNvcnQoKSB7CiAgICAgIHRoaXMudXNlcnMuc29ydCh0aGlzLmNvbXBhcmVOYW1lcykKICAgICAgdGhpcy5zb3J0VHlwZSAqPSAtMQogICAgICAKICAgIH0sCiAgICBjb21wYXJlTmFtZXModTEsdTIpIHsKICAgICAgaWYodTEubmFtZSA+IHUyLm5hbWUpIHJldHVybiAxICogdGhpcy5zb3J0VHlwZQogICAgICBlbHNlIGlmKHUxLm5hbWUgPCB1Mi5uYW1lKSByZXR1cm4gLTEgKiB0aGlzLnNvcnRUeXBlCiAgICAgIGVsc2UgcmV0dXJuIDAKICAgIH0sCgogICAgdmlld1VzZXIoaWQpIHsKICAgICAgY29uc3QgdXNlciA9IHRoaXMudXNlcnMuZmluZCh1c2VyID0+IHVzZXIuX2lkID09PSBpZCk7CiAgICAgIHRoaXMuJGZpcmUoewogICAgICAgIHRpdGxlOiB1c2VyLmF1dGgudXNlcm5hbWUsCiAgICAgICAgaHRtbDogdGhpcy5nZW5lcmF0ZVRlbXBsYXRlKHVzZXIpLAogICAgICAgIGltYWdlVXJsOiByZXF1aXJlKGBAL2Fzc2V0cy9hdmF0YXJzLyR7dGhpcy5nZXRVc2VyTGV2ZWxCeVBvaW50cyh1c2VyLmdhbWlmaWNhdGlvbi5wb2ludHMpLmF2YXRhcn0ucG5nYCksCiAgICAgICAgaW1hZ2VXaWR0aDogMTUwLAogICAgICAgIGltYWdlSGVpZ2h0OiAxNTAsCiAgICAgICAgaW1hZ2VBbHQ6ICJJbWFnZW0gZGVzY29uaGVjaWRhIgogICAgICB9KTsKICAgIH0sCgogICAgZ2VuZXJhdGVUZW1wbGF0ZSh1c2VyKSB7CiAgICAgIHJldHVybiBgCiAgICAgICAgICA8aDU+JHt1c2VyLmdhbWlmaWNhdGlvbi5wb2ludHN9IHBvbnRvcyAoJHt0aGlzLmdldFVzZXJMZXZlbEJ5UG9pbnRzKHVzZXIuZ2FtaWZpY2F0aW9uLnBvaW50cykubmFtZX0pPC9oNT4KICAgICAgICAgIDxwPiR7dXNlci5kZXNjcmlwdGlvbn08L3A+CiAgICAgICAgICA8cD4KICAgICAgICAgIDxiPk5vbWU6PC9iPiAke3VzZXIubmFtZX0gPGJyPgogICAgICAgICAgPGI+VGlwbyBkZSB1dGlsaXphZG9yOjwvYj4gJHt1c2VyLnR5cGU9PT0iYWRtaW4iPyJBZG1pbmlzdHJhZG9yIjoiVXRpbGl6YWRvciBub3JtYWwifSA8YnI+CiAgICAgICAgICA8Yj5EYXRhIGRlIHJlZ2lzdG86PC9iPiAke3RoaXMuZm9ybWF0RGF0ZSh1c2VyLnJlZ2lzdHJhdGlvbl9kYXRlKX0gPGJyPgogICAgICAgICAgPGI+RGF0YSBkZSBuYXNjaW1lbnRvOjwvYj4gJHt0aGlzLmZvcm1hdERhdGUodXNlci5iaXJ0aF9kYXRlKX08YnI+CiAgICAgICAgICA8Yj5DaWRhZGU6PC9iPiAke3VzZXIubG9jYXRpb24uY2l0eX08YnI+CiAgICAgICAgICA8Yj5QYcOtczo8L2I+ICR7dXNlci5sb2NhdGlvbi5jb3VudHJ5fQogICAgICAgICAgPC9wPgogICAgICAgIGAKICAgIH0sCiAgICBmb3JtYXREYXRlOiBkID0+IAogICAgewogICAgICBjb25zdCBuZXdEYXRlID0gbmV3IERhdGUoRGF0ZS5wYXJzZShkKSkKICAgICAgcmV0dXJuIG5ld0RhdGUuZ2V0RnVsbFllYXIoKSArICItIiArIChuZXdEYXRlLmdldE1vbnRoKCkgKyAxKSArICItIiArIG5ld0RhdGUuZ2V0RGF0ZSgpICsgIiAiICsgbmV3RGF0ZS5nZXRIb3VycygpICsgIjoiICsgbmV3RGF0ZS5nZXRNaW51dGVzKCkgKyAiOiIgKyBuZXdEYXRlLmdldFNlY29uZHMoKQogICAgfSwKICAgIHJlbW92ZVVzZXIoaWQpIHsKICAgICAgdGhpcy4kY29uZmlybSgKICAgICAgICAiU2Ugc2ltLCBjbGlxdWUgZW0gT0siLAogICAgICAgICJEZXNlamEgbWVzbW8gcmVtb3ZlciBvIHV0aWxpemFkb3I/IiwKICAgICAgICAid2FybmluZyIsCiAgICAgICAgeyBjb25maXJtQnV0dG9uVGV4dDogIk9LIiwgY2FuY2VsQnV0dG9uVGV4dDogIkNhbmNlbGFyIiB9CiAgICAgICkudGhlbigKICAgICAgICAoKSA9PiB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaChgdXNlci8ke1JFTU9WRV9VU0VSfWAsIGlkKS50aGVuKCgpID0+IHsKICAgICAgICAgICAgdGhpcy4kYWxlcnQoCiAgICAgICAgICAgICAgdGhpcy5nZXRNZXNzYWdlLAogICAgICAgICAgICAgICJVdGlsaXphZG9yIHJlbW92aWRvISIsCiAgICAgICAgICAgICAgInN1Y2Nlc3MiCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHRoaXMuZmV0Y2hVc2VycygpOwogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICAoKSA9PiB7CiAgICAgICAgICB0aGlzLiRhbGVydCgiUmVtb8Onw6NvIGNhbmNlbGFkYSEiLCAiSW5mb3JtYcOnw6NvIiwgImluZm8iKTsKICAgICAgICB9CiAgICAgICk7CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5mZXRjaFVzZXJzKCk7ICAgIAogIH0KfTsK"},{"version":3,"sources":["ListUsers.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ListUsers.vue","sourceRoot":"src/views/users","sourcesContent":["<template>\n  <section class=\"page-section\">\n    <b-container>\n     <HeaderPage title=\"Gestão de Utilizadores\"/>\n      \n      <!--MENU TOPO-->\n      <b-row class=\"mb-4\">\n        <b-col cols=\"1\"></b-col>\n        <b-col>\n          <router-link\n            :to=\"{name:'addUser'}\"\n            tag=\"button\"\n            class=\"btn btn-outline-success mr-2 mt-2\"\n          ><i class=\"fas fa-plus-square\"></i> ADICIONAR UTILIZADOR</router-link>\n          <router-link\n            :to=\"{name:'admin'}\"\n            tag=\"button\"\n            class=\"btn btn-outline-info mr-2 mt-2\"\n          ><i class=\"fas fa-bars\"></i> MENU PRINCIPAL</router-link>\n        </b-col>\n        <b-col cols=\"1\"></b-col>\n      </b-row>\n\n      <!-- TABELA -->\n      <b-row>\n        <b-col cols=\"1\"></b-col>\n        <b-col>\n          <table class=\"table table-striped\">\n            <thead class=\"thead-dark\">\n              <tr>\n                <th scope=\"col\">\n                  NOME\n                  <i class=\"fas fa-arrow-up\" v-if=\"sortType===1\" @click=\"sort()\"></i>\n                  <i class=\"fas fa-arrow-down\" v-else  @click=\"sort()\"></i>\n                </th>\n                <th scope=\"col\">TIPO</th>\n                <th scope=\"col\">DATA DE CRIAÇÃO</th>\n                <th scope=\"col\">AÇÕES</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"user of users\" :key=\"user._id\">                \n                <td class=\"pt-4\">{{user.name}}</td>\n                <td class=\"pt-4\">{{user.type===\"admin\"?\"Administrador\":\"Utilizador normal\"}}</td>\n                <td class=\"pt-4\">{{formatDate(user.registration_date)}}</td>\n                <td>\n                  <router-link\n                    :to=\"{name:'editUser', params:{userId: user._id}}\"\n                    tag=\"button\"\n                    class=\"btn btn-outline-success mr-2\"\n                  ><i class=\"fas fa-edit\"></i> EDITAR</router-link>\n                  <button\n                    @click=\"viewUser(user._id)\"\n                    type=\"button\"\n                    class=\"btn btn-outline-success mr-2\"\n                  ><i class=\"fas fa-search\"></i> VER</button>\n                  <button\n                    @click=\"removeUser(user._id)\"\n                    type=\"button\"\n                    class=\"btn btn-outline-danger mr-2 \"\n                  ><i class=\"fas fa-trash-alt\"></i> REMOVER</button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </b-col>\n        <b-col cols=\"1\"></b-col>\n      </b-row>\n    </b-container>\n  </section>\n</template>\n\n<script>\nimport { FETCH_USERS, REMOVE_USER } from \"@/store/users/user.constants\";\nimport HeaderPage from \"@/components/HeaderPage.vue\"\nimport { mapGetters } from \"vuex\";\n\nexport default {\n  name: \"ManageUsers\",\n  components: {\n    HeaderPage\n  },\n  data: function() {\n    return {\n      users: [],\n      sortType: 1\n    };\n  },\n  computed: {    \n    ...mapGetters([\"getUserLevelByPoints\"]),\n    ...mapGetters(\"user\", [\"getUsers\",\"getMessage\"])\n  },\n  methods: {\n    fetchUsers() {\n      this.$store.dispatch(`user/${FETCH_USERS}`).then( \n        () => {\n          this.users = this.getUsers;\n        }, err => {\n          this.$alert(`${err.message}`, 'Erro', 'error');\n        });\n    },\n    sort() {\n      this.users.sort(this.compareNames)\n      this.sortType *= -1\n      \n    },\n    compareNames(u1,u2) {\n      if(u1.name > u2.name) return 1 * this.sortType\n      else if(u1.name < u2.name) return -1 * this.sortType\n      else return 0\n    },\n\n    viewUser(id) {\n      const user = this.users.find(user => user._id === id);\n      this.$fire({\n        title: user.auth.username,\n        html: this.generateTemplate(user),\n        imageUrl: require(`@/assets/avatars/${this.getUserLevelByPoints(user.gamification.points).avatar}.png`),\n        imageWidth: 150,\n        imageHeight: 150,\n        imageAlt: \"Imagem desconhecida\"\n      });\n    },\n\n    generateTemplate(user) {\n      return `\n          <h5>${user.gamification.points} pontos (${this.getUserLevelByPoints(user.gamification.points).name})</h5>\n          <p>${user.description}</p>\n          <p>\n          <b>Nome:</b> ${user.name} <br>\n          <b>Tipo de utilizador:</b> ${user.type===\"admin\"?\"Administrador\":\"Utilizador normal\"} <br>\n          <b>Data de registo:</b> ${this.formatDate(user.registration_date)} <br>\n          <b>Data de nascimento:</b> ${this.formatDate(user.birth_date)}<br>\n          <b>Cidade:</b> ${user.location.city}<br>\n          <b>País:</b> ${user.location.country}\n          </p>\n        `\n    },\n    formatDate: d => \n    {\n      const newDate = new Date(Date.parse(d))\n      return newDate.getFullYear() + \"-\" + (newDate.getMonth() + 1) + \"-\" + newDate.getDate() + \" \" + newDate.getHours() + \":\" + newDate.getMinutes() + \":\" + newDate.getSeconds()\n    },\n    removeUser(id) {\n      this.$confirm(\n        \"Se sim, clique em OK\",\n        \"Deseja mesmo remover o utilizador?\",\n        \"warning\",\n        { confirmButtonText: \"OK\", cancelButtonText: \"Cancelar\" }\n      ).then(\n        () => {\n          this.$store.dispatch(`user/${REMOVE_USER}`, id).then(() => {\n            this.$alert(\n              this.getMessage,\n              \"Utilizador removido!\",\n              \"success\"\n            );\n            this.fetchUsers();\n          });\n        },\n        () => {\n          this.$alert(\"Remoção cancelada!\", \"Informação\", \"info\");\n        }\n      );\n    }\n  },\n  created() {\n    this.fetchUsers();    \n  }\n};\n</script>"]}]}